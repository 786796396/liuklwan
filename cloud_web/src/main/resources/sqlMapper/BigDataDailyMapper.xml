<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ucap.cloud_web.dao.BigDataDailyDao">

	<cache eviction="LRU" flushInterval="60000" size="1024" readOnly="true"/>

	<resultMap type="com.ucap.cloud_web.entity.BigDataDaily" id="resultMap"/>

	<sql id="where">
		<where>
			1=1
			
		</where>
	</sql>

	<!-- 添加 -->
	<insert id="add" parameterType="com.ucap.cloud_web.entity.BigDataDaily" useGeneratedKeys="true" keyProperty="id">
		insert into big_data_daily ( 
			<if test="id != null ">id,</if>
			<if test="sitecode != null ">sitecode,</if>
			<if test="status != null ">status,</if>
			<if test="countyear != null ">countyear,</if>
			<if test="countmonth != null ">countmonth,</if>
			<if test="countday != null ">countday,</if>
			<if test="linkerrnum != null ">linkerrnum,</if>
			<if test="linkerrprop != null ">linkerrprop,</if>
			<if test="linkerrprop7 != null ">linkerrprop7,</if>
			<if test="linkerrprop14 != null ">linkerrprop14,</if>
			<if test="linkerrprop30 != null ">linkerrprop30,</if>
			<if test="indexloadtime != null ">indexloadtime,</if>
			<if test="indexloadtime7 != null ">indexloadtime7,</if>
			<if test="indexloadtime14 != null ">indexloadtime14,</if>
			<if test="indexloadtime30 != null ">indexloadtime30,</if>
			<if test="updatenum != null ">updatenum,</if>
			<if test="updatenum7 != null ">updatenum7,</if>
			<if test="updatenum14 != null ">updatenum14,</if>
			<if test="updatenum30 != null ">updatenum30,</if>
			<if test="updatestatus != null ">updatestatus,</if>
			<if test="updatestatus7 != null ">updatestatus7,</if>
			<if test="updatestatus14 != null ">updatestatus14,</if>
			<if test="updatestatus30 != null ">updatestatus30,</if>
			<if test="aveupdatenum != null ">aveupdatenum,</if>
			<if test="aveupdatenum7 != null ">aveupdatenum7,</if>
			<if test="aveupdatenum14 != null ">aveupdatenum14,</if>
			<if test="aveupdatenum30 != null ">aveupdatenum30,</if>
			<if test="indexsize != null ">indexsize,</if>
			<if test="indexsize2 != null ">indexsize2,</if>
			<if test="indexsize7 != null ">indexsize7,</if>
			<if test="indexlinknum != null ">indexlinknum,</if>
			<if test="indexlinknum2 != null ">indexlinknum2,</if>
			<if test="indexlinknum7 != null ">indexlinknum7,</if>
			<if test="indexdeadnum != null ">indexdeadnum,</if>
			<if test="indexdeadnum7 != null ">indexdeadnum7,</if>
			<if test="indexdeadnum14 != null ">indexdeadnum14,</if>
			<if test="indexdeadnum30 != null ">indexdeadnum30,</if>
			<if test="indexdeadprop != null ">indexdeadprop,</if>
			<if test="indexdeadprop7 != null ">indexdeadprop7,</if>
			<if test="indexdeadprop14 != null ">indexdeadprop14,</if>
			<if test="indexdeadprop30 != null ">indexdeadprop30,</if>
			<if test="insidedeadlinknum != null ">insidedeadlinknum,</if>
			<if test="outsidedeadlinknum != null ">outsidedeadlinknum,</if>
			<if test="insideurlnum != null ">insideurlnum,</if>
			<if test="insideurlnum2 != null ">insideurlnum2,</if>
			<if test="insideurlnum7 != null ">insideurlnum7,</if>
			<if test="outsideurlnum != null ">outsideurlnum,</if>
			<if test="outsideurlnum2 != null ">outsideurlnum2,</if>
			<if test="outsideurlnum7 != null ">outsideurlnum7,</if>
			<if test="alert != null ">alert,</if>
			<if test="lastupdatedate != null ">lastupdatedate,</if>
			<if test="noupdateday != null ">noupdateday,</if>
			<if test="updatecodes != null ">updatecodes,</if>
			<if test="linkerrnum7 != null ">linkerrnum7,</if>
			<if test="linkerrnum14 != null ">linkerrnum14,</if>
			<if test="linkerrnum30 != null ">linkerrnum30,</if>
			<if test="linktotalnum != null ">linktotalnum,</if>
			<if test="linktotalnum7 != null ">linktotalnum7,</if>
			<if test="linktotalnum14 != null ">linktotalnum14,</if>
			<if test="linktotalnum30 != null ">linktotalnum30,</if>
			<if test="healthindex != null ">healthindex,</if>
			<if test="healthindex7 != null ">healthindex7,</if>
			<if test="healthindex14 != null ">healthindex14,</if>
			<if test="healthindex30 != null ">healthindex30,</if>
			create_time,
			modify_time
		) values (
			<if test="id != null ">#{id},</if>
			<if test="sitecode != null ">#{sitecode},</if>
			<if test="status != null ">#{status},</if>
			<if test="countyear != null ">#{countyear},</if>
			<if test="countmonth != null ">#{countmonth},</if>
			<if test="countday != null ">#{countday},</if>
			<if test="linkerrnum != null ">#{linkerrnum},</if>
			<if test="linkerrprop != null ">#{linkerrprop},</if>
			<if test="linkerrprop7 != null ">#{linkerrprop7},</if>
			<if test="linkerrprop14 != null ">#{linkerrprop14},</if>
			<if test="linkerrprop30 != null ">#{linkerrprop30},</if>
			<if test="indexloadtime != null ">#{indexloadtime},</if>
			<if test="indexloadtime7 != null ">#{indexloadtime7},</if>
			<if test="indexloadtime14 != null ">#{indexloadtime14},</if>
			<if test="indexloadtime30 != null ">#{indexloadtime30},</if>
			<if test="updatenum != null ">#{updatenum},</if>
			<if test="updatenum7 != null ">#{updatenum7},</if>
			<if test="updatenum14 != null ">#{updatenum14},</if>
			<if test="updatenum30 != null ">#{updatenum30},</if>
			<if test="updatestatus != null ">#{updatestatus},</if>
			<if test="updatestatus7 != null ">#{updatestatus7},</if>
			<if test="updatestatus14 != null ">#{updatestatus14},</if>
			<if test="updatestatus30 != null ">#{updatestatus30},</if>
			<if test="aveupdatenum != null ">#{aveupdatenum},</if>
			<if test="aveupdatenum7 != null ">#{aveupdatenum7},</if>
			<if test="aveupdatenum14 != null ">#{aveupdatenum14},</if>
			<if test="aveupdatenum30 != null ">#{aveupdatenum30},</if>
			<if test="indexsize != null ">#{indexsize},</if>
			<if test="indexsize2 != null ">#{indexsize2},</if>
			<if test="indexsize7 != null ">#{indexsize7},</if>
			<if test="indexlinknum != null ">#{indexlinknum},</if>
			<if test="indexlinknum2 != null ">#{indexlinknum2},</if>
			<if test="indexlinknum7 != null ">#{indexlinknum7},</if>
			<if test="indexdeadnum != null ">#{indexdeadnum},</if>
			<if test="indexdeadnum7 != null ">#{indexdeadnum7},</if>
			<if test="indexdeadnum14 != null ">#{indexdeadnum14},</if>
			<if test="indexdeadnum30 != null ">#{indexdeadnum30},</if>
			<if test="indexdeadprop != null ">#{indexdeadprop},</if>
			<if test="indexdeadprop7 != null ">#{indexdeadprop7},</if>
			<if test="indexdeadprop14 != null ">#{indexdeadprop14},</if>
			<if test="indexdeadprop30 != null ">#{indexdeadprop30},</if>
			<if test="insidedeadlinknum != null ">#{insidedeadlinknum},</if>
			<if test="outsidedeadlinknum != null ">#{outsidedeadlinknum},</if>
			<if test="insideurlnum != null ">#{insideurlnum},</if>
			<if test="insideurlnum2 != null ">#{insideurlnum2},</if>
			<if test="insideurlnum7 != null ">#{insideurlnum7},</if>
			<if test="outsideurlnum != null ">#{outsideurlnum},</if>
			<if test="outsideurlnum2 != null ">#{outsideurlnum2},</if>
			<if test="outsideurlnum7 != null ">#{outsideurlnum7},</if>
			<if test="alert != null ">#{alert},</if>
			<if test="lastupdatedate != null ">#{lastupdatedate},</if>
			<if test="noupdateday != null ">#{noupdateday},</if>
			<if test="updatecodes != null ">#{updatecodes},</if>
			<if test="linkerrnum7 != null ">#{linkerrnum7},</if>
			<if test="linkerrnum14 != null ">#{linkerrnum14},</if>
			<if test="linkerrnum30 != null ">#{linkerrnum30},</if>
			<if test="linktotalnum != null ">#{linktotalnum},</if>
			<if test="linktotalnum7 != null ">#{linktotalnum7},</if>
			<if test="linktotalnum14 != null ">#{linktotalnum14},</if>
			<if test="linktotalnum30 != null ">#{linktotalnum30},</if>
			<if test="healthindex != null ">#{healthindex},</if>
			<if test="healthindex7 != null ">#{healthindex7},</if>
			<if test="healthindex14 != null ">#{healthindex14},</if>
			<if test="healthindex30 != null ">#{healthindex30},</if>
			now(),
			now()
		)
		<selectKey resultType="int" keyProperty="id">
			SELECT LAST_INSERT_ID() AS id
		</selectKey>
	</insert>

	<!-- 查询 -->
	<select id="get" parameterType="int" resultType="com.ucap.cloud_web.entity.BigDataDaily">
		select * from big_data_daily where id=#{id}
	</select>

	<!-- 修改 -->
	<update id="update" parameterType="com.ucap.cloud_web.entity.BigDataDaily">
		update big_data_daily 
			<trim prefix="SET" suffixOverrides=",">
				<if test="id != null ">id = #{id},</if>
				<if test="sitecode != null ">sitecode = #{sitecode},</if>
				<if test="status != null ">status = #{status},</if>
				<if test="countyear != null ">countyear = #{countyear},</if>
				<if test="countmonth != null ">countmonth = #{countmonth},</if>
				<if test="countday != null ">countday = #{countday},</if>
				<if test="linkerrnum != null ">linkerrnum = #{linkerrnum},</if>
				<if test="linkerrprop != null ">linkerrprop = #{linkerrprop},</if>
				<if test="linkerrprop7 != null ">linkerrprop7 = #{linkerrprop7},</if>
				<if test="linkerrprop14 != null ">linkerrprop14 = #{linkerrprop14},</if>
				<if test="linkerrprop30 != null ">linkerrprop30 = #{linkerrprop30},</if>
				<if test="indexloadtime != null ">indexloadtime = #{indexloadtime},</if>
				<if test="indexloadtime7 != null ">indexloadtime7 = #{indexloadtime7},</if>
				<if test="indexloadtime14 != null ">indexloadtime14 = #{indexloadtime14},</if>
				<if test="indexloadtime30 != null ">indexloadtime30 = #{indexloadtime30},</if>
				<if test="updatenum != null ">updatenum = #{updatenum},</if>
				<if test="updatenum7 != null ">updatenum7 = #{updatenum7},</if>
				<if test="updatenum14 != null ">updatenum14 = #{updatenum14},</if>
				<if test="updatenum30 != null ">updatenum30 = #{updatenum30},</if>
				<if test="updatestatus != null ">updatestatus = #{updatestatus},</if>
				<if test="updatestatus7 != null ">updatestatus7 = #{updatestatus7},</if>
				<if test="updatestatus14 != null ">updatestatus14 = #{updatestatus14},</if>
				<if test="updatestatus30 != null ">updatestatus30 = #{updatestatus30},</if>
				<if test="aveupdatenum != null ">aveupdatenum = #{aveupdatenum},</if>
				<if test="aveupdatenum7 != null ">aveupdatenum7 = #{aveupdatenum7},</if>
				<if test="aveupdatenum14 != null ">aveupdatenum14 = #{aveupdatenum14},</if>
				<if test="aveupdatenum30 != null ">aveupdatenum30 = #{aveupdatenum30},</if>
				<if test="indexsize != null ">indexsize = #{indexsize},</if>
				<if test="indexsize2 != null ">indexsize2 = #{indexsize2},</if>
				<if test="indexsize7 != null ">indexsize7 = #{indexsize7},</if>
				<if test="indexlinknum != null ">indexlinknum = #{indexlinknum},</if>
				<if test="indexlinknum2 != null ">indexlinknum2 = #{indexlinknum2},</if>
				<if test="indexlinknum7 != null ">indexlinknum7 = #{indexlinknum7},</if>
				<if test="indexdeadnum != null ">indexdeadnum = #{indexdeadnum},</if>
				<if test="indexdeadnum7 != null ">indexdeadnum7 = #{indexdeadnum7},</if>
				<if test="indexdeadnum14 != null ">indexdeadnum14 = #{indexdeadnum14},</if>
				<if test="indexdeadnum30 != null ">indexdeadnum30 = #{indexdeadnum30},</if>
				<if test="indexdeadprop != null ">indexdeadprop = #{indexdeadprop},</if>
				<if test="indexdeadprop7 != null ">indexdeadprop7 = #{indexdeadprop7},</if>
				<if test="indexdeadprop14 != null ">indexdeadprop14 = #{indexdeadprop14},</if>
				<if test="indexdeadprop30 != null ">indexdeadprop30 = #{indexdeadprop30},</if>
				<if test="insidedeadlinknum != null ">insidedeadlinknum = #{insidedeadlinknum},</if>
				<if test="outsidedeadlinknum != null ">outsidedeadlinknum = #{outsidedeadlinknum},</if>
				<if test="insideurlnum != null ">insideurlnum = #{insideurlnum},</if>
				<if test="insideurlnum2 != null ">insideurlnum2 = #{insideurlnum2},</if>
				<if test="insideurlnum7 != null ">insideurlnum7 = #{insideurlnum7},</if>
				<if test="outsideurlnum != null ">outsideurlnum = #{outsideurlnum},</if>
				<if test="outsideurlnum2 != null ">outsideurlnum2 = #{outsideurlnum2},</if>
				<if test="outsideurlnum7 != null ">outsideurlnum7 = #{outsideurlnum7},</if>
				<if test="alert != null ">alert = #{alert},</if>
				<if test="lastupdatedate != null ">lastupdatedate = #{lastupdatedate},</if>
				<if test="noupdateday != null ">noupdateday = #{noupdateday},</if>
				<if test="updatecodes != null ">updatecodes = #{updatecodes},</if>
				<if test="linkerrnum7 != null ">linkerrnum7 = #{linkerrnum7},</if>
				<if test="linkerrnum14 != null ">linkerrnum14 = #{linkerrnum14},</if>
				<if test="linkerrnum30 != null ">linkerrnum30 = #{linkerrnum30},</if>
				<if test="linktotalnum != null ">linktotalnum = #{linktotalnum},</if>
				<if test="linktotalnum7 != null ">linktotalnum7 = #{linktotalnum7},</if>
				<if test="linktotalnum14 != null ">linktotalnum14 = #{linktotalnum14},</if>
				<if test="linktotalnum30 != null ">linktotalnum30 = #{linktotalnum30},</if>
				<if test="healthindex != null ">healthindex = #{healthindex},</if>
				<if test="healthindex7 != null ">healthindex7 = #{healthindex7},</if>
				<if test="healthindex14 != null ">healthindex14 = #{healthindex14},</if>
				<if test="healthindex30 != null ">healthindex30 = #{healthindex30},</if>
				<if test="createTime != null ">create_time = #{createTime},</if>
				<if test="modifyTime != null ">modify_time = #{modifyTime},</if>
			</trim>
			where id=#{id} 
	</update>

	<!-- 删除 -->
	<delete id="delete" parameterType="int">
		delete from big_data_daily where id = #{id}
	</delete>

	<!-- 分页查询 -->
	<select id="query" parameterType="HashMap" resultMap="resultMap">
		select * from big_data_daily
		<include refid="where"/>
		<if test="queryOrderList != null">
			order by
			<foreach collection="queryOrderList" item="queryOrder" separator=",">
				${queryOrder}
			</foreach>
		</if>
		<if test="start != null and pageSize != null">
			limit #{start}, #{pageSize}
		</if>
	</select>
	<select id="queryCount" parameterType="HashMap" resultType="int">
		select count(*) from big_data_daily
		<include refid="where" />
	</select>
	
	<select id="queryOrganizations" parameterType="HashMap" resultType="com.ucap.cloud_web.dtoResponse.BigDataDailyResponse">
		SELECT b.*,d.jump_url jumpUrl,d.url url,d.name name,d.province,d.city,d.county
		<if test="orderVal !=null and orderVal!='null'">
			,${orderVal} as orderVal 
		</if>
		from database_tree_info t   
		join database_tree_info tt on tt.parent_id = t.id
		join  big_data_daily b on b.sitecode = tt.site_code 
		join  database_info d  on d.site_code = tt.site_code 
		<where>
		<if test="orgSiteCode != null "> 
			and b.org_site_code = #{orgSiteCode}
		</if>
		<if test="countDay != null "> 
			and b.countday = #{countDay}
		</if>
		<if test="parentId != null">
		  	and t.parent_id =  #{parentId}  
		</if>
		<if test="isBm != null">
			and tt.is_bm=#{isBm}
		</if>
		<if test="noupdatedayNo != null ">
			and b.noupdateday !=#{noupdatedayNo}
		</if>
			and d.isorganizational = 1
			and t.is_bigdata='1'
			and tt.is_bigdata='1'
		</where>
		<if test="queryOrderList != null">
			order by
			<foreach collection="queryOrderList" item="queryOrder" separator=",">
				${queryOrder}
			</foreach>
		</if>
		<if test="startIndex != null and pageSize != null">
			limit ${startIndex}, ${pageSize}
		</if>
	</select>
	<select id="queryNatives" parameterType="HashMap" resultType="com.ucap.cloud_web.dtoResponse.BigDataDailyResponse">
		SELECT b.*,d.jump_url jumpUrl,d.url url,d.name,d.province,d.city,d.county
		<if test="orderVal !=null and orderVal!='null'">
			,${orderVal} as orderVal 
		</if>
		from database_tree_info t   
		join  big_data_daily b on b.sitecode = t.site_code 
		join  database_info d  on d.site_code = t.site_code 
		<where>
		<if test="orgSiteCode != null "> 
			and t.org_site_code = #{orgSiteCode}
		</if>
		<if test="countDay != null "> 
			and b.countday = #{countDay}
		</if>
		<if test="parentId != null">
		  	and t.parent_id =  #{parentId}  
		</if>
		<if test="noupdatestatusStr != null and noupdatestatus != null">
			and ${noupdatestatusStr} = #{noupdatestatus}
		</if>
		<if test="siteCodeLength != null ">
			and length(t.site_code)=#{siteCodeLength}
		</if>
		<if test="codeLike != null ">
			and t.code like concat(#{codeLike},'%')
		</if>
		<if test="noupdatedayNo != null ">
			and b.noupdateday !=#{noupdatedayNo}
		</if>
		 	and t.is_bigdata=1
		</where> 
		<if test="queryOrderList != null">
			order by
			<foreach collection="queryOrderList" item="queryOrder" separator=",">
				${queryOrder}
			</foreach>
		</if>
		<if test="startIndex != null and pageSize != null">
			limit ${startIndex}, ${pageSize}
		</if>
	</select>

</mapper>
