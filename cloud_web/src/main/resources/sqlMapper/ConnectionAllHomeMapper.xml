<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd"><mapper namespace="com.ucap.cloud_web.dao.ConnectionAllHomeDao">	<cache eviction="LRU" flushInterval="60000" size="1024" readOnly="true"/>	<resultMap type="com.ucap.cloud_web.entity.ConnectionAllHome" id="resultMap"/>	<sql id="where">		<where>			1=1					</where>	</sql>	<!-- 添加 -->	<insert id="add" parameterType="com.ucap.cloud_web.entity.ConnectionAllHome" useGeneratedKeys="true" keyProperty="id">		insert into connection_all_home ( 			<if test="id != null ">id,</if>			<if test="siteCode != null ">site_code,</if>			<if test="name != null ">name,</if>			<if test="url != null ">url,</if>			<if test="queue != null ">queue,</if>			<if test="type != null ">type,</if>			<if test="channelNum != null ">channel_num,</if>			<if test="scanDate != null ">scan_date,</if>			<if test="connectionSum != null ">connection_sum,</if>			<if test="successNum != null ">success_num,</if>			<if test="successProportion != null ">success_proportion,</if>			<if test="errorNum != null ">error_num,</if>			<if test="errorProportion != null ">error_proportion,</if>			create_time,			modify_time		) values (			<if test="id != null ">#{id},</if>			<if test="siteCode != null ">#{siteCode},</if>			<if test="name != null ">#{name},</if>			<if test="url != null ">#{url},</if>			<if test="queue != null ">#{queue},</if>			<if test="type != null ">#{type},</if>			<if test="channelNum != null ">#{channelNum},</if>			<if test="scanDate != null ">#{scanDate},</if>			<if test="connectionSum != null ">#{connectionSum},</if>			<if test="successNum != null ">#{successNum},</if>			<if test="successProportion != null ">#{successProportion},</if>			<if test="errorNum != null ">#{errorNum},</if>			<if test="errorProportion != null ">#{errorProportion},</if>			now(),			now()		)		<selectKey resultType="int" keyProperty="id">			SELECT LAST_INSERT_ID() AS id		</selectKey>	</insert>	<!-- 查询 -->	<select id="get" parameterType="int" resultType="com.ucap.cloud_web.entity.ConnectionAllHome">		select * from connection_all_home where id=#{id}	</select>	<!-- 修改 -->	<update id="update" parameterType="com.ucap.cloud_web.entity.ConnectionAllHome">		update connection_all_home 			<trim prefix="SET" suffixOverrides=",">				<if test="id != null ">id = #{id},</if>				<if test="siteCode != null ">site_code = #{siteCode},</if>				<if test="name != null ">name = #{name},</if>				<if test="url != null ">url = #{url},</if>				<if test="queue != null ">queue = #{queue},</if>				<if test="type != null ">type = #{type},</if>				<if test="channelNum != null ">channel_num = #{channelNum},</if>				<if test="scanDate != null ">scan_date = #{scanDate},</if>				<if test="connectionSum != null ">connection_sum = #{connectionSum},</if>				<if test="successNum != null ">success_num = #{successNum},</if>				<if test="successProportion != null ">success_proportion = #{successProportion},</if>				<if test="errorNum != null ">error_num = #{errorNum},</if>				<if test="errorProportion != null ">error_proportion = #{errorProportion},</if>				<if test="createTime != null ">create_time = #{createTime},</if>				<if test="modifyTime != null ">modify_time = #{modifyTime},</if>			</trim>			where id=#{id} 	</update>	<!-- 删除 -->	<delete id="delete" parameterType="int">		delete from connection_all_home where id = #{id}	</delete>	<!-- 分页查询 -->	<select id="query" parameterType="HashMap" resultMap="resultMap">		select * from connection_all_home		<include refid="where"/>		<if test="queryOrderList != null">			order by			<foreach collection="queryOrderList" item="queryOrder" separator=",">				${queryOrder}			</foreach>		</if>		<if test="start != null and pageSize != null">			limit #{start}, #{pageSize}		</if>	</select>	<select id="queryCount" parameterType="HashMap" resultType="int">		select count(*) from connection_all_home		<include refid="where" />	</select>	<select id="getConnectionAllHomeList" parameterType="HashMap" resultType="com.ucap.cloud_web.dtoResponse.ConnectionAllHomeResponse">		SELECT			d.site_code siteCode,			d. NAME siteName,			d.url AS homePageUrl,			d.jump_url AS jumpPageUrl,			ca.queue,			ca.channel_num, 			IFNULL(sum(ca.connection_sum), 0) connectionSum, 			IFNULL(sum(ca.success_num), 0) successNum,			ca.success_proportion successProportion, 			IFNULL(sum(ca.error_num), 0) errorNum,			ca.error_proportion errorProportion					FROM			database_info d,			connection_all_home ca,			database_tree_info dti		WHERE			ca.site_code = dti.site_code		AND d.site_code = dti.site_code		<if test="queue != null">			and ca.queue = #{queue}		</if>		<if test="type != null">			and ca.type = #{type}		</if>		<if test="startDate != null and endDate != null">			and (ca.scan_date between #{startDate} and #{endDate})		</if>		<if test="orgSiteCode != null">			and dti.org_site_code= #{orgSiteCode}		</if>		<if test="isLink != null">			and dti.is_link = #{isLink}		</if>		<if test="siteType != null">			and dti.layer_type = #{siteType}		</if>		GROUP BY			ca.site_code		ORDER BY			 ABS(errorProportion) DESC;	</select></mapper>
