<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd"><mapper namespace="com.ucap.cloud_web.dao.ErrorInfoDao">	<cache eviction="LRU" flushInterval="60000" size="1024" readOnly="true"/>	<resultMap type="com.ucap.cloud_web.entity.ErrorInfo" id="resultMap"/>	<sql id="where">		<where>			1=1			<if test="typeVal != null ">and problem_id = #{typeVal}</if>		</where>	</sql>	<!-- 添加 -->	<insert id="add" parameterType="com.ucap.cloud_web.entity.ErrorInfo" useGeneratedKeys="true" keyProperty="id">		insert into error_info ( 			<if test="id != null ">id,</if>			<if test="errorInfoId != null ">error_info_id,</if>			<if test="siteCode != null ">site_code,</if>			<if test="name != null ">name,</if>			<if test="problemId != null ">problem_id,</if>			<if test="errorUrl != null ">error_url,</if>			<if test="description != null ">description,</if>			<if test="status != null ">status,</if>			review_time,			<if test="displayContent != null ">display_content,</if>			<if test="transactUnit != null ">transact_unit,</if>			transact_time,			<if test="rejectReason != null ">reject_reason,</if>			<if test="transactResult != null ">transact_result,</if>			create_time,			modify_time		) values (			<if test="id != null ">#{id},</if>			<if test="errorInfoId != null ">#{errorInfoId},</if>			<if test="siteCode != null ">#{siteCode},</if>			<if test="name != null ">#{name},</if>			<if test="problemId != null ">#{problemId},</if>			<if test="errorUrl != null ">#{errorUrl},</if>			<if test="description != null ">#{description},</if>			<if test="status != null ">#{status},</if>			now(),			<if test="displayContent != null ">#{displayContent},</if>			<if test="transactUnit != null ">#{transactUnit},</if>			now(),			<if test="rejectReason != null ">#{rejectReason},</if>			<if test="transactResult != null ">#{transactResult},</if>			now(),			now()		)		<selectKey resultType="int" keyProperty="id">			SELECT LAST_INSERT_ID() AS id		</selectKey>	</insert>	<!-- 查询 -->	<select id="get" parameterType="int" resultType="com.ucap.cloud_web.entity.ErrorInfo">		select * from error_info where id=#{id}	</select>	<!-- 修改 -->	<update id="update" parameterType="com.ucap.cloud_web.entity.ErrorInfo">		update error_info 			<trim prefix="SET" suffixOverrides=",">				<if test="id != null ">id = #{id},</if>				<if test="errorInfoId != null ">error_info_id = #{errorInfoId},</if>				<if test="siteCode != null ">site_code = #{siteCode},</if>				<if test="name != null ">name = #{name},</if>				<if test="problemId != null ">problem_id = #{problemId},</if>				<if test="errorUrl != null ">error_url = #{errorUrl},</if>				<if test="description != null ">description = #{description},</if>				<if test="status != null ">status = #{status},</if>				<if test="reviewTime != null ">review_time = #{reviewTime},</if>				<if test="displayContent != null ">display_content = #{displayContent},</if>				<if test="transactUnit != null ">transact_unit = #{transactUnit},</if>				<if test="transactTime != null ">transact_time = #{transactTime},</if>				<if test="rejectReason != null ">reject_reason = #{rejectReason},</if>				<if test="transactResult != null ">transact_result = #{transactResult},</if>				<if test="createTime != null ">create_time = #{createTime},</if>				<if test="modifyTime != null ">modify_time = #{modifyTime},</if>			</trim>			where id=#{id} 	</update>	<!-- 删除 -->	<delete id="delete" parameterType="int">		delete from error_info where id = #{id}	</delete>	<!-- 分页查询 -->	<select id="query" parameterType="HashMap" resultMap="resultMap">		select * from error_info		<include refid="where"/>		<if test="queryOrderList != null">			order by			<foreach collection="queryOrderList" item="queryOrder" separator=",">				${queryOrder}			</foreach>		</if>		<if test="start != null and pageSize != null">			limit #{start}, #{pageSize}		</if>	</select>	<select id="queryCount" parameterType="HashMap" resultType="int">		select count(*) from error_info		<include refid="where" />	</select>			<select id="getErrorInfoList" parameterType="HashMap" resultMap="resultMap">		SELECT DISTINCT(dti.site_code),			e.id,			e.`name`,			e.problem_id,			e.review_time,			e.`status`		FROM			error_info e,			database_tree_info dti		WHERE			e.site_code = dti.site_code		<if test="code != null">  		 		AND dti.CODE LIKE CONCAT(#{code}, '%')		</if>		<if test="isBigdata != null">  		 		AND dti.is_bigdata = #{isBigdata}		</if>		AND LENGTH(dti.site_code) > 6		<if test="typeVal != null ">and e.problem_id = #{typeVal}</if>		<if test="exposureKeyId != null ">			and (e.site_code LIKE CONCAT('%',#{exposureKeyId},'%') or e.name LIKE CONCAT('%',#{exposureKeyId},'%') )		</if>		<if test="queryOrderList != null">			order by			<foreach collection="queryOrderList" item="queryOrder" separator=",">				${queryOrder}			</foreach>		</if>		<if test="start != null and pageSize != null">			limit #{start}, #{pageSize}		</if>	</select>	<select id="getErrorInfoCount" parameterType="HashMap" resultType="int">		 SELECT count(*)			FROM			error_info e,			database_tree_info dti		WHERE			e.site_code = dti.site_code		<if test="code != null">  		 		AND dti.CODE LIKE CONCAT(#{code}, '%')		</if>		<if test="isBigdata != null">  		 		AND dti.is_bigdata = #{isBigdata}		</if>		AND LENGTH(dti.site_code) > 6		<if test="typeVal != null ">and e.problem_id = #{typeVal}</if>		<if test="exposureKeyId != null ">			and (e.site_code LIKE CONCAT('%',#{exposureKeyId},'%') or e.name LIKE CONCAT('%',#{exposureKeyId},'%') )		</if>	</select>
</mapper>
