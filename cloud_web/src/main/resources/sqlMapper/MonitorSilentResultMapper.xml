<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd"><mapper namespace="com.ucap.cloud_web.dao.MonitorSilentResultDao">	<!-- <cache eviction="LRU" flushInterval="60000" size="1024" readOnly="true"/> -->	<resultMap type="com.ucap.cloud_web.entity.MonitorSilentResult" id="resultMap"/>	<sql id="where">		<where>			res_type = 0			<if test="siteCode != null "> and site_code = #{siteCode}</if>			<if test="scanDate != null "> and scan_date = #{scanDate}</if>			<if test="startDate != null and endDate != null"> and (scan_date between #{startDate} and #{endDate})</if>		</where>	</sql>	<!-- 添加 -->	<insert id="add" parameterType="com.ucap.cloud_web.entity.MonitorSilentResult" useGeneratedKeys="true" keyProperty="id">		insert into monitor_silent_result ( 			<if test="id != null ">id,</if>			<if test="databaseInfoId != null ">database_info_id,</if>			<if test="siteCode != null ">site_code,</if>			<if test="riskNum != null ">risk_num,</if>			<if test="silentNum != null ">silent_num,</if>			<if test="fragilityNum != null ">fragility_num,</if>			<if test="trojanNum != null ">trojan_num,</if>			<if test="tamperNum != null ">tamper_num,</if>			<if test="darkChainNum != null ">dark_chain_num,</if>			<if test="leakedNum != null ">leaked_num,</if>			<if test="scanDate != null ">scan_date,</if>			<if test="resType != null ">res_type,</if>			create_time,			modify_time		) values (			<if test="id != null ">#{id},</if>			<if test="databaseInfoId != null ">#{databaseInfoId},</if>			<if test="siteCode != null ">#{siteCode},</if>			<if test="riskNum != null ">#{riskNum},</if>			<if test="silentNum != null ">#{silentNum},</if>			<if test="fragilityNum != null ">#{fragilityNum},</if>			<if test="trojanNum != null ">#{trojanNum},</if>			<if test="tamperNum != null ">#{tamperNum},</if>			<if test="darkChainNum != null ">#{darkChainNum},</if>			<if test="leakedNum != null ">#{leakedNum},</if>			<if test="scanDate != null ">#{scanDate},</if>			<if test="resType != null ">#{resType},</if>			now(),			now()		)		<selectKey resultType="int" keyProperty="id">			SELECT LAST_INSERT_ID() AS id		</selectKey>	</insert>	<!-- 查询 -->	<select id="get" parameterType="int" resultType="com.ucap.cloud_web.entity.MonitorSilentResult">		select * from monitor_silent_result where id=#{id}	</select>	<!-- 修改 -->	<update id="update" parameterType="com.ucap.cloud_web.entity.MonitorSilentResult">		update monitor_silent_result 			<trim prefix="SET" suffixOverrides=",">				<if test="id != null ">id = #{id},</if>				<if test="databaseInfoId != null ">database_info_id = #{databaseInfoId},</if>				<if test="siteCode != null ">site_code = #{siteCode},</if>				<if test="riskNum != null ">risk_num = #{riskNum},</if>				<if test="silentNum != null ">silent_num = #{silentNum},</if>				<if test="fragilityNum != null ">fragility_num = #{fragilityNum},</if>				<if test="trojanNum != null ">trojan_num = #{trojanNum},</if>				<if test="tamperNum != null ">tamper_num = #{tamperNum},</if>				<if test="darkChainNum != null ">dark_chain_num = #{darkChainNum},</if>				<if test="leakedNum != null ">leaked_num = #{leakedNum},</if>				<if test="scanDate != null ">scan_date = #{scanDate},</if>				<if test="createTime != null ">create_time = #{createTime},</if>				<if test="modifyTime != null ">modify_time = #{modifyTime},</if>				<if test="resType != null ">res_type = #{resType},</if>			</trim>			where id=#{id} 	</update>	<!-- 删除 -->	<delete id="delete" parameterType="int">		delete from monitor_silent_result where id = #{id}	</delete>	<!-- 分页查询 -->	<select id="query" parameterType="HashMap" resultMap="resultMap">		select * from monitor_silent_result		<include refid="where"/>		<if test="queryOrderList != null">			order by			<foreach collection="queryOrderList" item="queryOrder" separator=",">				${queryOrder}			</foreach>		</if>		<if test="start != null and pageSize != null">			limit #{start}, #{pageSize}		</if>	</select>	<select id="queryCount" parameterType="HashMap" resultType="int">		select count(*) from monitor_silent_result		<include refid="where" />	</select>		<select id="getMonResMap" parameterType="HashMap" resultType="com.ucap.cloud_web.dto.MonitorSilentResultRequest">		SELECT			i.site_code AS siteCode,			i.`name`,			i.url AS url,			sum(m.risk_num) AS riskNum,			sum(m.fragility_num) AS fragilityNum,			sum(m.trojan_num) AS trojanNum,			sum(m.tamper_num) AS tamperNum,			sum(m.dark_chain_num) AS darkNhainNum,			sum(m.leaked_num) AS leakedNum		FROM			monitor_silent_result m		LEFT JOIN database_tree_info d ON d.site_code = m.site_code		LEFT JOIN database_info i ON i.site_code = m.site_code		WHERE			1 = 1		<if test="siteCode !=null ">			and d.org_site_code = #{siteCode}		</if> 		<if test="terms !=null ">			and CONCAT(i.site_code, i.name) like '%${terms}%'		</if> 		<if test="res !=null ">			and m.res_type = #{res}						<if test="res == 0">				<if test="scanDate != null "> 					and scan_date = #{scanDate}				</if> 			</if>			<if test="res == 1">				<if test="startDate != null and endDate != null"> 					and (scan_date between #{startDate} and #{endDate})				</if>			</if>			<if test="res == 2">				<if test="startDate != null and endDate != null"> 					and (scan_date between #{startDate} and #{endDate})				</if>			</if>			<if test="res == 3">				<if test="startDate != null and endDate != null"> 					and (scan_date between #{startDate} and #{endDate})				</if>			</if>		</if>					GROUP BY			m.site_code	</select>	
</mapper>
